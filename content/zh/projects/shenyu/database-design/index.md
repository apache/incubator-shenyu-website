---
title: 数据库设计
keywords: db
description: 数据库设计
---

## 插件设计
* 插件采用数据库设计，来存储插件，选择器，规则配置数据，以及对应关系。
* 数据库表 UML 类图:

 ![](/img/shenyu/db/shenyu-db.png)

* 设计详解:
  
   * 一个插件对应多个选择器，一个选择器对应多个规则。

   * 一个选择器对应多个匹配条件，一个规则对应多个匹配条件。

   * 每个规则在对应插件下，不同的处理表现为 handle 字段，handle 字段就是一个 json 字符串。具体的可以在 admin 使用过程中进行查看。

## 资源权限设计     
* 资源代表的是 admin 用户后台中的菜单或者按钮。

* 资源权限数据表用来存储用户名称、角色、资源数据以及对应关系。
   
* 数据库UML类图：

![](/img/shenyu/db/shenyu-permission-db.png)

* 设计详解:
   * 一个用户对应多个角色,一个角色对应多个资源。


## 数据权限设计
* 数据权限数据表用来存储用户，选择器、规则对应的关系。
* 数据库 UML 类图

![数据权限表设计](/img/shenyu/db/data_permission.png)

* 设计详解
   * 数据权限的表为： `data_permission`; 其中一个用户对应多条数据权限。
   * 数据权限表中字段 `data_type` 区分不同的类型数据， 具体对应关系如下：0 -> 选择器, 1 -> 规则。
   * 数据权限表中字段 `data_id` 存放相应类型的主键id。
    
